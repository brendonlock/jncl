
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
	<script src="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/js/1.2.5/ecwid-app.js"></script>
	<link rel="stylesheet" href="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.css"/>
<style>
/* Custom styles to remove a-card box shadow and border */
.a-card {
	border: none;
	border-radius: 0px;
	box-shadow: none;
}
</style>
<script>
	EcwidApp.init({
	app_id: "custom-app-28419181-1", // use your application namespace
	autoloadedflag: true, 
	autoheight: true
	});

	var storeData = EcwidApp.getPayload();

	var storeId = storeData.store_id;
	var accessToken = storeData.access_token;
	var language = storeData.lang;
	var viewMode = storeData.view_mode;

	if (storeData.public_token !== undefined){
	var publicToken = storeData.public_token;
	}

	if (storeData.app_state !== undefined){
	var appState = storeData.app_state;

	function showEditPage(elementClass){
	document.querySelector('.main').style.display = 'none';
	document.querySelector(elementClass).style.display = 'block';
	document.querySelector('.content-control-menu-nav').style.display = 'flex';
}

	function goBack(){
		document.querySelector('.content-control-menu-nav').style.display = 'none';
		document.querySelector('.main').style.display = 'block';

		// hide all separate pages for editing
		for(i=0;i<document.querySelectorAll('.separate-editing-page').length; i++) {
			document.querySelectorAll('.separate-editing-page')[i].style.display = 'none';
		}
	}

	function readValuesFromPage(){

		var applicationConfig = {
			public: {},
			private: {}
		}

		var allInputs = document.querySelectorAll('input, select, textarea');

		for (i=0; i<allInputs.length; i++){
			var fieldVisibility = allInputs[i].dataset.visibility;

			if(fieldVisibility !== undefined){
				if(allInputs[i].tagName == "INPUT"){
						
					if(allInputs[i].type == 'checkbox' || allInputs[i].type == 'radio'){
						applicationConfig[fieldVisibility][allInputs[i].dataset.name] = String(allInputs[i].checked) ;
					}
					if(allInputs[i].type == 'text' || allInputs[i].type == 'number' || allInputs[i].type == 'date') {
						applicationConfig[fieldVisibility][allInputs[i].dataset.name] = allInputs[i].value;	
					}
				}
				if(allInputs[i].tagName == "SELECT" || allInputs[i].tagName == "TEXTAREA"){
					applicationConfig[fieldVisibility][allInputs[i].dataset.name] = allInputs[i].value;
				}
			}
		}

		applicationConfig.public = JSON.stringify(applicationConfig.public);

		return applicationConfig;
	}

	// Reads values from provided config and sets them for inputs on the page. 
	// To fill values successfully, the input, select or textarea elements must have 'data-name' and 'data-visibility' attributes set. See appProto.html for examples

	function setValuesForPage(applicationConfig){

		var applicationConfigTemp = {
			public: {},
			private: {}
		};

		// for cases when we get existing users' data

		if (applicationConfig.constructor === Array){
			for (i=0; i < applicationConfig.length; i++) {
				if (applicationConfig[i].key !== 'public'){
					applicationConfigTemp.private[applicationConfig[i].key] = applicationConfig[i].value;
				} else {
					applicationConfigTemp[applicationConfig[i].key] = applicationConfig[i].value;
				}
			}
			applicationConfig = applicationConfigTemp;
		}

		applicationConfig.public = JSON.parse(applicationConfig.public);
		var allInputs = document.querySelectorAll('input, select, textarea');

		// Set values from config for input, select, textarea elements
		
		for (i=0; i<allInputs.length; i++){
			var fieldVisibility = allInputs[i].dataset.visibility;

			if(fieldVisibility !== undefined && applicationConfig[fieldVisibility][allInputs[i].dataset.name] !== undefined){
				if(allInputs[i].tagName == "INPUT"){

					if(allInputs[i].type == 'checkbox' || allInputs[i].type == 'radio'){
						allInputs[i].checked = (applicationConfig[fieldVisibility][allInputs[i].dataset.name] == "true");
						checkFieldChange(allInputs[i]);
					}
					if(allInputs[i].type == 'text' || allInputs[i].type == 'number' || allInputs[i].type == 'date') {
						allInputs[i].value = applicationConfig[fieldVisibility][allInputs[i].dataset.name];
						checkFieldChange(allInputs[i]);
					}
				}
				if(allInputs[i].tagName == "SELECT" || allInputs[i].tagName == "TEXTAREA"){
					allInputs[i].value = applicationConfig[fieldVisibility][allInputs[i].dataset.name];
					checkFieldChange(allInputs[i]);
				}
			}
		}	
	}

	// Default settings for new accounts

	var initialConfig = {
		private: {
			cardNumber: "",
			cardExpirationMonth: "",
			cardExpirationYear: "",
			endpointUrl: "https://secure2.authorize.net/gateway/transact.dll",
			testMode: "true",
			installed: "yes"
		},
		public: {}
	};

	initialConfig.public = JSON.stringify(initialConfig.public);

	// Executes when we have a new user install the app. It creates and sets the default data using Ecwid JS SDK and Application storage

	function createUserData() {

		// Saves data for application storage 
		EcwidApp.setAppStorage(initialConfig.private, function(value){
			console.log('Initial private user preferences saved!');
		});

		// Saves data for public app config
		EcwidApp.setAppPublicConfig(initialConfig.public, function(value){
			console.log('Initial public user preferences saved!');
		});

		// Function to prepopulate values of select, input and textarea elements based on default settings for new accounts
		setValuesForPage(initialConfig);
	}


	// Executes if we have a user who logs in to the app not the first time. We load their preferences from Application storage with Ecwid JS SDK and display them in the app interface

	function getUserData() {

		// Retrieve all keys and values from application storage, including public app config. Set the values for select, input and textarea elements on a page in a callback

		EcwidApp.getAppStorage(function(allValues){
			setValuesForPage(allValues);
		});

	}

	// Executes when we need to save data. Gets all elements' values and saves them to Application storage and public app config via Ecwid JS SDK

	function saveUserData() {

		var saveData = readValuesFromPage();

		EcwidApp.setAppStorage(saveData.private, function(savedData){
			console.log('Private preferences saved!');
		});

		EcwidApp.setAppPublicConfig(saveData.public, function(savedData){
			console.log('Public preferences saved!');
		})

	}

	function resetUserData(initialConfig) {
		setValuesForPage(initialConfig);
		saveUserData();
	}


	// Main app function to determine if the user is new or just logs into the app

	EcwidApp.getAppStorage('installed', function(value){

		if (value !== null) {
			getUserData();
		}
		else {
			createUserData();
		}
	})
	}

</script>

</head>
<body>
<div>
		<div>
			<div class="named-area">
				<div class="named-area__body">


<!-- Check input element for example of how to set data attributes to save to storage later -->

					<div class="a-card a-card--normal">
						<div class="a-card__paddings">
							<div class="payment-method">
								<div class="payment-method__header">
									<div class="payment-method__logo">
										<img src="https://bit.ly/3i0tUE5" width="336" height="144" alt="">
									</div>
									<div class="payment-method__credit-cards">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 26" width="40px" height="26px"><path fill="#FFF" d="M0 0h40v25.41H0z"></path><path fill="#F7B600" d="M1 22h38v3H1z"></path><path fill="#1A1F71" d="M1 1h38v3H1zM15.46 8l-4.13 9.84H8.64L6.61 9.99c-.12-.48-.23-.66-.61-.86-.61-.34-1.62-.65-2.51-.84L3.55 8h4.33c.55 0 1.05.37 1.17 1l1.07 5.7L12.78 8h2.68zM26 14.63c.01-2.6-3.59-2.74-3.57-3.9.01-.35.34-.73 1.08-.82.36-.05 1.37-.08 2.51.44l.45-2.09c-.61-.22-1.4-.43-2.38-.43-2.52 0-4.29 1.34-4.3 3.25-.02 1.42 1.26 2.21 2.23 2.68.99.48 1.33.79 1.32 1.22-.01.66-.79.95-1.52.96-1.28.02-2.02-.35-2.61-.62l-.46 2.16c.6.27 1.69.51 2.83.52 2.66 0 4.41-1.32 4.42-3.37m6.65 3.22H35L32.94 8h-2.17c-.49 0-.9.28-1.08.72l-3.82 9.12h2.67l.53-1.47h3.27l.31 1.48zm-2.85-3.49l1.34-3.7.77 3.7H29.8zM19.09 8l-2.1 9.84h-2.55L16.55 8h2.54z"></path></svg>
									</div>
								</div>
								<div class="payment-method__title">Payment Gateway Portal. Developed and designed by Brendon Lock</div>
								<div class="payment-method__content">
									<div class="form-area">
										<div class="form-area__content">
											<p>Please set your Card details below. These are important so you can recieve payments</p>
										</div>

										<div class="columned">
											<div class="columned__item">
												<div class="form-area__title">Card Details:</div>
												<div class="form-area__content">
													<div class="fieldsets-batch">
														<div class="fieldset">
															<div class="fieldset__field-wrapper">
																<div class="field field--medium">
																	<span class="fieldset__svg-icon"></span>
																	<label class="field__label">Card Number</label>

					<!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
																	<input data-name="cardNumber" data-visibility="private" type="text" class="field__input">
																	
																	<div class="field__placeholder">Card Number</div>
																	<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
																	<span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0 c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73 c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
																</div>
																<div class="fieldset__field-prefix"></div>
																<div class="fieldset__field-suffix"></div>
															</div>
															<div class="field__error" aria-hidden="true" style="display: none;"></div>
															<div class="fieldset__note" aria-hidden="true" style="display: none;"></div>
														</div>
														<div class="fieldset">
															<div class="fieldset__field-wrapper">
																<div class="field field--medium">
																	<span class="fieldset__svg-icon"></span>
																	<label class="field__label">Card Expiration Month</label>

					<!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
																	<input data-name="cardExpirationMonth" data-visibility="private" type="text" class="field__input">
																	
																	<div class="field__placeholder">Card Expiration Month</div>
																	<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
																	<span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0 c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73 c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
																</div>
																<div class="fieldset__field-prefix"></div>
																<div class="fieldset__field-suffix"></div>
															</div>
															<div class="field__error" aria-hidden="true" style="display: none;"></div>
															<div class="fieldset__note" aria-hidden="true" style="display: none;"></div>
														</div>
														<div class="fieldset">
															<div class="fieldset__field-wrapper">
																<div class="field field--medium">
																	<span class="fieldset__svg-icon"></span>
																	<label class="field__label">Card Expiration Year</label>

					<!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
																	<input data-name="cardExpirationYear" data-visibility="private" type="text" class="field__input">


																	<div class="field__placeholder">Card Expiration Year</div>
																	<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span><span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0 c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73 c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
																</div>
																<div class="fieldset__field-prefix"></div>
																<div class="fieldset__field-suffix"></div>
															</div>
															<div class="field__error" aria-hidden="true" style="display: none;"></div>

															<div class="fieldset__note" aria-hidden="true" style="display: none;"></div>
														</div>
													</div>
													<div class="inline-alert inline-alert--error">This payment processor accepts only Visa.</div>
												</div>

												

<!-- Advanced settings START-->
												<div class="collapsible">
													<div class="collapsible__header">Advanced settings</div>
													<div class="collapsible__body">
														<div class="form-area__content">
															<div class="fieldsets-batch">
																<div class="fieldset">
																	<div class="fieldset__field-wrapper">
																		<div class="field field--medium field--filled">
																			<span class="fieldset__svg-icon"></span>
																			<label class="field__label">Endpoint URL</label>


					<!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
																			<input data-name="endpointUrl" data-visibility="private" type="text" class="field__input" value="yo">
																			

																			<div class="field__placeholder">Endpoint URL</div>
																			<span class="field-state--success"><svg xmlns="http://www.w3.org/2000/svg" width="26px" height="26px" viewBox="0 0 26 26" focusable="false"><path d="M5 12l5.02 4.9L21.15 4c.65-.66 1.71-.66 2.36 0 .65.67.65 1.74 0 2.4l-12.3 14.1c-.33.33-.76.5-1.18.5-.43 0-.86-.17-1.18-.5l-6.21-6.1c-.65-.66-.65-1.74 0-2.41.65-.65 1.71-.65 2.36.01z"></path></svg></span>
																			<span class="field-state--close"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve" focusable="false"><path d="M15.6,15.5c-0.53,0.53-1.38,0.53-1.91,0L8.05,9.87L2.31,15.6c-0.53,0.53-1.38,0.53-1.91,0 c-0.53-0.53-0.53-1.38,0-1.9l5.65-5.64L0.4,2.4c-0.53-0.53-0.53-1.38,0-1.91c0.53-0.53,1.38-0.53,1.91,0l5.64,5.63l5.74-5.73 c0.53-0.53,1.38-0.53,1.91,0c0.53,0.53,0.53,1.38,0,1.91L9.94,7.94l5.66,5.65C16.12,14.12,16.12,14.97,15.6,15.5z"></path></svg></span>
																		</div>
																		<div class="fieldset__field-prefix"></div>
																		<div class="fieldset__field-suffix"></div>
																	</div>
																	<div class="field__error" aria-hidden="true" style="display: none;"></div>
																	<div class="fieldset__note">Use this option to emulate the Authorize.Net SIM API. See details in our <a target="_blank" href="http://kb.ecwid.com/w/page/49187841/AuthorizeNet%20Emulation">Knowledge Base</a>.
																	</div>
																</div>
																<button type="button" onclick="resetUserData(initialConfig);" class="btn btn-default btn-medium">Reset</button>
															</div>
														</div>
														<div class="form-area__content">
															<div class="custom-checkbox">
																<label>


					<!-- Instruction title input. Use data attributes as below to save and update the value to/from application storage via functions.js -->
																	<input data-name="testMode" data-visibility="private" type="checkbox" checked="true" value="on" class="custom-checkbox__input">


																	<span class="custom-checkbox__label"></span>
																	<span class="custom-checkbox__text">Enable test mode (no charges)</span>
																</label>
																<div class="custom-checkbox__note muted text-small">Please make sure you are using test Alias/Key and Salt values (not production).</div>
															</div>
														</div>
													</div>
												</div>

<!-- Advanced settings END -->

											</div>

<!-- Payment instructions block START -->											
											<div class="columned__item columned__item--shifted">
												<div class="form-area__title">Configure Account</div>
												<div class="form-area__content">
													<ul class="bullet">
														<li>Enter your card details</li>
														<li>Click <b>Settings</b> tab on Dashboard menu bar.</li>
														<li>Select "Change Alias &amp; View Salt".</li>
														<li>Copy the values.</li>
													</ul>
													<p>In order to enable and use <a href="http://reseller.authorize.net/application/?id=5555901" target="_blank">Authorize.Net</a> SIM as payment option, you need to fill in the form below.</p>
												</div>
											</div>
<!-- Payment instructions block END -->

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<script src='functions.js'></script>
<script src="https://d35z3p2poghz10.cloudfront.net/ecwid-sdk/css/1.3.8/ecwid-app-ui.min.js"></script>

<script>

// Autosave feature for fields. Complimentary JS for the one from SDK above

(function initFieldset() {

	var elms = document.querySelectorAll('.field__input, .field__select, .field__textarea, .radio, .custom-checkbox__input');
	for (var i = 0; i < elms.length; i++) {
		elms[i].addEventListener('blur', function(e) {
			checkFieldChange(this);
			if (this.classList.contains('field__input') || this.classList.contains('field__textarea')) {
				saveUserData();
			}
		}, false);

		elms[i].addEventListener('change', function() {
			if (this.value) {
				saveUserData(); 
			}
			else {				
				saveUserData();
			}
		}, false);

		elms[i].addEventListener('click', function() {
			if (this.value) {
				saveUserData(); 
			}
			else {
				saveUserData();
			}
		}, false);
 	}
})();

</script>

</body>
</html>

